---
title: "Police Employee Numbers By County"
output: html_document
date: "2024-04-09"
by: Alisha Camacho
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Description

Using the data made available from the FBI Crime Data Explorer at the county level, I am looking at the police employment percentage changes between 2019 and 2021 by county. Data for 2022 and 2023 was not made available at this time. I exported the data to upload to Datawrapper to produce a map that shows the percentage change by county. 

Next, I looked at the congregated data for the entire state of Maryland to determine state-wide police employment trends. 

I found a nearly 12% decline in law enforcement between 2019 and 2021, and nearly an 11% decline between 2020 and 2021. 


## Load Libraries
rm(list=ls())

```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
library(janitor)
```

**LOAD DATA**

Data Source: FBI Crime Data Explorer
Data Link: https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/downloads

Navigation: Additional Datasets --> Law Enforcement Employees Data
File: pe_1960_2022.csv
Description: Information about Law Enforcement Employees Data
Date Accessed: April 24, 2024

The file *pe_1960_2022.csv* can also be accessed with this link 
https://drive.google.com/file/d/1ABIZemLpN7mH25g0cz-GabVKQI8_8xIF/view?usp=sharing

The .csv was too large to export into GitHub directly. 


```{r}
police <- read.csv("Data/pe_1960_2022.csv")


glimpse(police)

```


```{r}

#select MD data only

police_md <- police %>% 
  filter(state_abbr == "MD") %>% 
  select(data_year, pub_agency_name, county_name, total_pe_ct, pe_ct_per_1000) %>% 
  arrange(desc(data_year))
  
glimpse(police_md)

police_md


```


**Police Employee Percentage Change by County Between 2019 and 2021**

```{r}
difference_2019_2021 <- police_md %>% 
  filter(data_year %in% c(2019, 2021)) %>% 
  group_by(county_name) %>% 
   summarise(police_count_2019 = sum(total_pe_ct[data_year == 2019]),
            police_count_2021 = sum(total_pe_ct[data_year == 2021])) %>% 
   mutate(percentage_change = (police_count_2021 - police_count_2019) / police_count_2019 * 100) %>% 
  arrange(percentage_change) 


difference_2019_2021
```

#County Map Percentage Change 2019-2021

```{r}

difference_2019_2021 <- police_md %>% 
  filter(data_year %in% c(2019, 2021)) %>% 
  group_by(county_name) %>% 
  summarise(police_count_2019 = sum(total_pe_ct[data_year == 2019]),
            police_count_2021 = sum(total_pe_ct[data_year == 2021])) %>% 
  mutate(percentage_change = (police_count_2021 - police_count_2019) / police_count_2019 * 100) %>% 
  select(county_name, percentage_change) %>% 
  filter(!(county_name %in% c('UNMAPPED COUNTY', 'NOT SPECIFIED', "CARROLL, FREDERICK"))) %>% 
  arrange(percentage_change) 

difference_2019_2021

```

```{r}
#clean county names

difference_2019_2021_Clean <- difference_2019_2021 %>% 
  mutate(county_name = case_when(
    county_name == "ST MARY'S" ~ "ST. MARY'S",
    county_name == "BALTIMORE" ~ "BALTIMORE COUNTY",
    TRUE ~ county_name
  ), 
    percentage_change = round(percentage_change, 0)
  
  )
  
difference_2019_2021_Clean

```



#Export Files & Use to Create Map on Datawrapper

datawrapper graphic/map: https://app.datawrapper.de/map/Atsix/visualize#refine


```{r}

#Police difference 2019 - 2021 by county

write.csv(difference_2019_2021_Clean, file = "police_county_2019_2021_export_clean.csv")

```


####


**STATE-WIDE ANALYSIS**


#extract md data only

```{r}

police_md2 <- police %>% 
  filter(state_abbr == "MD") %>% 
  select(data_year, pub_agency_name, county_name, total_pe_ct, pe_ct_per_1000) %>% 
  arrange(desc(data_year))
 # group_by(data_year)
  
glimpse(police_md)

police_md2

```

#filter for 2019 and 2021

```{r}

state_difference_2019_2021 <- police_md2 %>% 
  filter(data_year %in% c(2019, 2021)) %>% 
  group_by(data_year) %>% 
  summarise(state_police_count = sum(total_pe_ct))
  

state_difference_2019_2021

```

#percent change

```{r}

state_difference_total_2019_2021 <- state_difference_2019_2021 %>% 
  mutate(percentage_change = (state_police_count - lag(state_police_count)) / lag(state_police_count) * 100)

print(state_difference_total_2019_2021)

#nearly a 12% decrease between 2019 and 2021

```


###


#filter for 2020 and 2021

```{r}

state_difference_2020_2021 <- police_md2 %>% 
  filter(data_year %in% c(2020, 2021)) %>% 
  group_by(data_year) %>% 
  summarise(state_police_count = sum(total_pe_ct))
  

state_difference_2020_2021

```


#percent change

```{r}

state_difference_total_2020_2021 <- state_difference_2020_2021 %>% 
  mutate(percentage_change = (state_police_count - lag(state_police_count)) / lag(state_police_count) * 100)

print(state_difference_total_2020_2021)

#nearly a 11% decrease between 2020 and 2021

```
